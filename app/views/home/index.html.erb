
<h2>chart</h2>

<%= select 'home', 'select_manager', User.all.collect { |u| ["#{u.name} #{u.surname} #{u.pantronymic}" , u.id] },
           {:include_blank => "Select user"}, {:class => 'form-control'} %>


<div class="input-daterange input-group" id="datepicker">
  <input type="text" class="input-sm form-control" name="start" />
  <span class="input-group-addon">to</span>
  <input type="text" class="input-sm form-control" name="end" />
</div>

<div id="chartContainer" style="height: 370px; width: 100%;"></div>


<script>

    $('.input-daterange').datepicker({});

  window.onload = function ()
  {


      var chart_data0 = [];

      var chart0 = new CanvasJS.Chart("chartContainer", {
          animationEnabled: true,
          title: {
              text: "Daily High Temperature at Different Beaches"
          },
          axisX: {
              valueFormatString: "DD MMM,YY"
          },
          axisY: {
              title: "Count",
              includeZero: false,
          },
          legend: {
              cursor: "pointer",
              fontSize: 16,
              itemclick: toggleDataSeries
          },
          toolTip: {
              shared: true
          },
          data: [{
              name: "Myrtle Beach",
              type: "spline",
              showInLegend: true,
              dataPoints: chart_data0
          }]
      });


       $.ajax({
          type: 'POST',
          url: "/home/chart_0",
          data: {id: 1},
          dataType: "json",
          success:function(data)
          {
              addData(data,chart_data0);
              chart0.render();
          },
          error:function(data)
          {
              console.log('ERROR');
          }
      });



  }

  function addData(data,result)
  {
      for (var i = 0; i < data.length; i++) {
          result.push({
              x: new Date(data[i].x),
              y: data[i].y
          });
      }
  }



  function toggleDataSeries(e)
  {
      if (typeof(e.dataSeries.visible) === "undefined" || e.dataSeries.visible) {
          e.dataSeries.visible = false;
      }
      else{
          e.dataSeries.visible = true;
      }
      chart0.render();
  }

</script>

